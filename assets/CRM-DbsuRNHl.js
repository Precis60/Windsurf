import{j as e,a as b,c as l}from"./index-BJHBaGN9.js";import{b as i}from"./vendor-DR4o8xae.js";const F=()=>{const[g,y]=i.useState(!1),[C,v]=i.useState(!0),[u,x]=i.useState([]),[j,n]=i.useState(!1),[c,f]=i.useState(!1),[m,p]=i.useState(null),[r,o]=i.useState({companyName:"",contactName:"",email:"",phone:"",address:"",city:"",state:"",zipCode:"",projectType:"",notes:""});i.useEffect(()=>{(()=>{const s=b.isAuthenticated();y(s),v(!1)})()},[]),i.useEffect(()=>{g&&(async()=>{try{const s=await l.getAll(),d=Array.isArray(s)?s:s.customers||[];x(d)}catch(s){console.error("Error loading customers:",s),x([])}})()},[g]);const w=async t=>{t.preventDefault(),console.log("Attempting to create customer with data:",r);try{const s={firstName:r.contactName.split(" ")[0]||r.contactName,lastName:r.contactName.split(" ").slice(1).join(" ")||"Customer",email:r.email,phone:r.phone,company:r.companyName,address:`${r.address}, ${r.city}, ${r.state} ${r.zipCode}`.trim()};console.log("Sending customer data to backend:",s);const d=await l.create(s);console.log("Customer created successfully:",d),o({companyName:"",contactName:"",email:"",phone:"",address:"",city:"",state:"",zipCode:"",projectType:"",notes:""}),n(!1);const h=await l.getAll(),A=Array.isArray(h)?h:h.customers||[];x(A),alert("Customer added successfully!")}catch(s){console.error("Detailed error adding customer:",s),console.error("Error message:",s.message);let d="Failed to add customer. ";s.message.includes("Authentication required")?(d+="Please log in again.",window.location.href="/login"):s.message.includes("Session expired")?(d+="Your session has expired. Please log in again.",window.location.href="/login"):d+=`Error: ${s.message}`,alert(d)}},S=async t=>{t.preventDefault();try{await l.update(m,r),o({companyName:"",contactName:"",email:"",phone:"",address:"",city:"",state:"",zipCode:"",projectType:"",notes:""}),p(null),n(!1)}catch(s){console.error("Error updating customer:",s),alert("Failed to update customer. Please try again.")}},N=t=>{o({companyName:t.companyName,contactName:t.contactName,email:t.email,phone:t.phone,address:t.address,city:t.city,state:t.state,zipCode:t.zipCode,projectType:t.projectType,notes:t.notes}),p(t.id),n(!0)},k=async t=>{if(window.confirm("Are you sure you want to delete this customer?"))try{await l.delete(t)}catch(s){console.error("Error deleting customer:",s),alert("Failed to delete customer. Please try again.")}},a={background:"#22314a",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"4px",cursor:"pointer",margin:"0 0.5rem"};return C?e.jsx("div",{className:"page-content",style:{padding:"2rem",display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:e.jsxs("div",{style:{textAlign:"center",color:"#666"},children:[e.jsx("h2",{children:"Loading CRM..."}),e.jsx("p",{children:"Please wait while we load your customer data."})]})}):g?e.jsxs("div",{className:"page-content",style:{padding:"2rem",maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h1",{style:{color:"#22314a",margin:0},children:"Customer Relationship Management"}),e.jsx("button",{onClick:()=>{b.logout(),y(!1),window.location.href="/"},style:{...a,background:"#dc3545"},children:"Logout"})]}),e.jsx("p",{style:{marginBottom:"2rem",fontSize:"1.1rem"},children:"Manage customer relationships and track project progress."}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem"},children:[e.jsxs("div",{style:{background:"#f8f9fa",padding:"1.5rem",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsx("h3",{style:{color:"#22314a",marginBottom:"1rem"},children:"Customer Database"}),e.jsx("p",{children:"View and manage customer information, contact details, and project history."}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginTop:"1rem"},children:[e.jsx("button",{onClick:()=>{f(!c),n(!1),p(null)},style:{...a,width:"100%",padding:"0.5rem 1rem",fontSize:"0.9rem"},children:c?"Hide Customers":"View Customers"}),e.jsx("button",{onClick:()=>{console.log("Add Customer button clicked"),n(!0),f(!1),p(null),o({companyName:"",contactName:"",email:"",phone:"",address:"",city:"",state:"",zipCode:"",projectType:"",notes:""})},style:{...a,background:"#28a745",width:"100%",padding:"0.5rem 1rem",fontSize:"0.9rem"},children:"Add Customer"})]})]}),e.jsxs("div",{style:{background:"#f8f9fa",padding:"1.5rem",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsx("h3",{style:{color:"#22314a",marginBottom:"1rem"},children:"Active Projects"}),e.jsxs("ul",{style:{listStyle:"none",padding:0},children:[e.jsx("li",{style:{padding:"0.5rem 0",borderBottom:"1px solid #dee2e6"},children:"Office Building Wiring - 75% Complete"}),e.jsx("li",{style:{padding:"0.5rem 0",borderBottom:"1px solid #dee2e6"},children:"Factory Automation - 40% Complete"}),e.jsx("li",{style:{padding:"0.5rem 0"},children:"Warehouse Network - Planning Phase"})]})]}),e.jsxs("div",{style:{background:"#f8f9fa",padding:"1.5rem",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsx("h3",{style:{color:"#22314a",marginBottom:"1rem"},children:"Recent Activity"}),e.jsxs("ul",{style:{listStyle:"none",padding:0},children:[e.jsx("li",{style:{padding:"0.5rem 0",borderBottom:"1px solid #dee2e6"},children:"New quote sent to ABC Corp"}),e.jsx("li",{style:{padding:"0.5rem 0",borderBottom:"1px solid #dee2e6"},children:"Project milestone reached"}),e.jsx("li",{style:{padding:"0.5rem 0"},children:"Customer feedback received"})]})]})]}),e.jsxs("div",{style:{marginTop:"3rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsx("h2",{style:{color:"#22314a",margin:0},children:"🔐 Company Password Manager"}),e.jsx("button",{onClick:()=>{setShowPasswordForm(!showPasswordForm),setEditingCredential(null),setCredentialForm({serviceName:"",username:"",password:"",website:"",notes:""})},style:a,children:showPasswordForm?"Cancel":"Add New Credential"})]}),showPasswordForm&&e.jsxs("div",{style:{background:"#f8f9fa",padding:"1.5rem",borderRadius:"8px",border:"1px solid #e9ecef",marginBottom:"2rem"},children:[e.jsx("h3",{style:{color:"#22314a",marginBottom:"1rem"},children:editingCredential?"Edit Credential":"Add New Credential"}),e.jsxs("form",{onSubmit:editingCredential?handleUpdateCredential:handleAddCredential,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[e.jsx("input",{type:"text",placeholder:"Service/Software Name",value:credentialForm.serviceName,onChange:t=>setCredentialForm({...credentialForm,serviceName:t.target.value}),required:!0,style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"}}),e.jsx("input",{type:"text",placeholder:"Username/Email",value:credentialForm.username,onChange:t=>setCredentialForm({...credentialForm,username:t.target.value}),required:!0,style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"}}),e.jsx("input",{type:"password",placeholder:"Password",value:credentialForm.password,onChange:t=>setCredentialForm({...credentialForm,password:t.target.value}),required:!0,style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"}}),e.jsx("input",{type:"url",placeholder:"Website URL (optional)",value:credentialForm.website,onChange:t=>setCredentialForm({...credentialForm,website:t.target.value}),style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"}})]}),e.jsx("textarea",{placeholder:"Notes (optional)",value:credentialForm.notes,onChange:t=>setCredentialForm({...credentialForm,notes:t.target.value}),style:{width:"100%",padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc",minHeight:"60px",marginBottom:"1rem"}}),e.jsx("button",{type:"submit",style:a,children:editingCredential?"Update Credential":"Save Credential"})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(350px, 1fr))",gap:"1rem"},children:savedCredentials.length===0?e.jsx("div",{style:{background:"#f8f9fa",padding:"2rem",borderRadius:"8px",border:"1px solid #e9ecef",textAlign:"center",color:"#666"},children:e.jsx("p",{children:'No credentials saved yet. Click "Add New Credential" to get started.'})}):savedCredentials.map(t=>e.jsxs("div",{style:{background:"#fff",padding:"1.5rem",borderRadius:"8px",border:"1px solid #dee2e6",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[e.jsx("h4",{style:{color:"#22314a",margin:0,fontSize:"1.1rem"},children:t.serviceName}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>handleEditCredential(t),style:{...a,padding:"0.25rem 0.5rem",fontSize:"0.8rem",background:"#28a745"},children:"Edit"}),e.jsx("button",{onClick:()=>handleDeleteCredential(t.id),style:{...a,padding:"0.25rem 0.5rem",fontSize:"0.8rem",background:"#dc3545"},children:"Delete"})]})]}),e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Username:"})," ",t.username]}),e.jsxs("div",{style:{marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("strong",{children:"Password:"}),e.jsx("span",{style:{fontFamily:"monospace"},children:showPasswords[t.id]?t.password:"••••••••"}),e.jsx("button",{onClick:()=>togglePasswordVisibility(t.id),style:{...a,padding:"0.25rem 0.5rem",fontSize:"0.7rem",background:"#6c757d"},children:showPasswords[t.id]?"Hide":"Show"})]}),t.website&&e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Website:"}),e.jsx("a",{href:t.website,target:"_blank",rel:"noopener noreferrer",style:{color:"#007bff",textDecoration:"none"},children:t.website})]}),t.notes&&e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Notes:"})," ",t.notes]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"#666",marginTop:"1rem"},children:["Added: ",t.dateAdded]})]},t.id))})]}),(j||c)&&e.jsxs("div",{style:{marginTop:"3rem"},children:[e.jsx("h2",{style:{color:"#22314a",marginBottom:"1.5rem"},children:"👥 Customer Management"}),j&&e.jsxs("div",{style:{background:"#f8f9fa",padding:"1.5rem",borderRadius:"8px",border:"1px solid #e9ecef",marginBottom:"2rem"},children:[e.jsx("h3",{style:{color:"#22314a",marginBottom:"1rem"},children:m?"Edit Customer":"Add New Customer"}),e.jsxs("form",{onSubmit:m?S:w,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[e.jsx("input",{type:"text",placeholder:"Company Name",value:r.companyName,onChange:t=>o({...r,companyName:t.target.value}),required:!0,style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"}}),e.jsx("input",{type:"text",placeholder:"Contact Name",value:r.contactName,onChange:t=>o({...r,contactName:t.target.value}),required:!0,style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"}}),e.jsx("input",{type:"email",placeholder:"Email Address",value:r.email,onChange:t=>o({...r,email:t.target.value}),required:!0,style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"}}),e.jsx("input",{type:"tel",placeholder:"Phone Number",value:r.phone,onChange:t=>o({...r,phone:t.target.value}),required:!0,style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"}}),e.jsx("input",{type:"text",placeholder:"Street Address",value:r.address,onChange:t=>o({...r,address:t.target.value}),style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"}}),e.jsx("input",{type:"text",placeholder:"City",value:r.city,onChange:t=>o({...r,city:t.target.value}),style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"}}),e.jsx("input",{type:"text",placeholder:"State",value:r.state,onChange:t=>o({...r,state:t.target.value}),style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"}}),e.jsx("input",{type:"text",placeholder:"ZIP Code",value:r.zipCode,onChange:t=>o({...r,zipCode:t.target.value}),style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"}}),e.jsxs("select",{value:r.projectType,onChange:t=>o({...r,projectType:t.target.value}),required:!0,style:{padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc"},children:[e.jsx("option",{value:"",children:"Select Project Type"}),e.jsx("option",{value:"Network Infrastructure",children:"Network Infrastructure"}),e.jsx("option",{value:"Cable Installation",children:"Cable Installation"}),e.jsx("option",{value:"Equipment Setup",children:"Equipment Setup"}),e.jsx("option",{value:"Maintenance",children:"Maintenance"}),e.jsx("option",{value:"Consultation",children:"Consultation"}),e.jsx("option",{value:"System Integration",children:"System Integration"}),e.jsx("option",{value:"Upgrade",children:"Upgrade"}),e.jsx("option",{value:"Emergency Service",children:"Emergency Service"})]})]}),e.jsx("textarea",{placeholder:"Notes (optional)",value:r.notes,onChange:t=>o({...r,notes:t.target.value}),style:{width:"100%",padding:"0.5rem",borderRadius:"4px",border:"1px solid #ccc",minHeight:"80px",marginBottom:"1rem"}}),e.jsx("button",{type:"submit",style:a,children:m?"Update Customer":"Save Customer"})]})]}),c&&e.jsxs("div",{children:[e.jsxs("h3",{style:{color:"#22314a",marginBottom:"1rem"},children:["Customer Database (",u.length," customers)"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:"1rem"},children:u.length===0?e.jsx("div",{style:{background:"#f8f9fa",padding:"2rem",borderRadius:"8px",border:"1px solid #e9ecef",textAlign:"center",color:"#666"},children:e.jsx("p",{children:'No customers added yet. Click "Add Customer" to get started.'})}):u.map(t=>e.jsxs("div",{style:{background:"#fff",padding:"1.5rem",borderRadius:"8px",border:"1px solid #dee2e6",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[e.jsx("h4",{style:{color:"#22314a",margin:0,fontSize:"1.2rem"},children:t.companyName}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>N(t),style:{...a,padding:"0.25rem 0.5rem",fontSize:"0.8rem",background:"#28a745"},children:"Edit"}),e.jsx("button",{onClick:()=>k(t.id),style:{...a,padding:"0.25rem 0.5rem",fontSize:"0.8rem",background:"#dc3545"},children:"Delete"})]})]}),e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Contact:"})," ",t.contactName]}),e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Email:"}),e.jsx("a",{href:`mailto:${t.email}`,style:{color:"#007bff",textDecoration:"none",marginLeft:"0.5rem"},children:t.email})]}),e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Phone:"}),e.jsx("a",{href:`tel:${t.phone}`,style:{color:"#007bff",textDecoration:"none",marginLeft:"0.5rem"},children:t.phone})]}),t.address&&e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Address:"})," ",t.address,t.city&&`, ${t.city}`,t.state&&`, ${t.state}`,t.zipCode&&` ${t.zipCode}`]}),e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Project Type:"}),e.jsx("span",{style:{background:"#e3f2fd",color:"#1976d2",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.8rem",marginLeft:"0.5rem"},children:t.projectType})]}),t.notes&&e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Notes:"})," ",t.notes]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"#666",marginTop:"1rem"},children:["Added: ",t.dateAdded]})]},t.id))})]})]})]}):e.jsx("div",{className:"page-content",style:{padding:"2rem",maxWidth:"600px",margin:"0 auto"},children:e.jsxs("div",{style:{background:"#f8f9fa",padding:"2rem",borderRadius:"8px",border:"1px solid #e9ecef",textAlign:"center"},children:[e.jsx("h1",{style:{color:"#22314a",marginBottom:"1rem"},children:"🔒 CRM Access Required"}),e.jsx("p",{style:{marginBottom:"2rem",fontSize:"1.1rem",color:"#666"},children:"Please log in to access the secure customer relationship management system."}),e.jsx("div",{style:{background:"#e8f5e8",border:"1px solid #4caf50",borderRadius:"8px",padding:"20px",marginBottom:"20px"},children:e.jsxs("p",{style:{margin:0,color:"#2e7d32",fontSize:"14px"},children:["🔐 ",e.jsx("strong",{children:"Secure Access:"})," This CRM contains sensitive customer information and requires authentication."]})}),e.jsx("a",{href:"/login",style:{background:"#22314a",color:"white",padding:"12px 24px",borderRadius:"8px",textDecoration:"none",fontSize:"16px",fontWeight:"500",display:"inline-block"},children:"Go to Login Page"})]})})};export{F as default};
