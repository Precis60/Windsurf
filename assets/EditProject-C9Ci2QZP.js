import{j as e,p as y,e as T}from"./index-DEqkr8Xv.js";import{d as A,u as D,b as o}from"./vendor-fHjEb_wq.js";const q=["Pending","In Progress","Completed"],R=[{id:"security",name:"Security"},{id:"access-control",name:"Access Control"},{id:"it",name:"Information Technology"},{id:"cctv",name:"CCTV"},{id:"consultation",name:"Consultation"},{id:"maintenance",name:"Routine Maintenance"},{id:"av",name:"Audio Visual"},{id:"automation",name:"Automation"},{id:"network",name:"Network Programming"},{id:"electrical",name:"Electrical Works"},{id:"contractor",name:"Contractor"},{id:"garden",name:"Garden Works"},{id:"lighting",name:"Electrical & Lighting"}],B=({status:i,onUpdate:l})=>{const r=a=>{l(a.target.value)},c=()=>{switch(i){case"Completed":return"#198754";case"In Progress":return"#0d6efd";default:return"#6c757d"}};return e.jsx("select",{value:i,onChange:r,style:{background:c(),color:"white",border:"none",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",cursor:"pointer"},children:q.map(a=>e.jsx("option",{value:a,style:{backgroundColor:"#fff",color:"#000"},children:a},a))})},E=({tasks:i})=>{const l=i.filter(a=>a.status==="Completed").length,r=i.length,c=r>0?l/r*100:0;return e.jsx("div",{style:{width:"100%",backgroundColor:"#e9ecef",borderRadius:"4px",overflow:"hidden",marginBottom:"1rem"},children:e.jsx("div",{style:{width:`${c}%`,backgroundColor:"#198754",height:"10px",transition:"width 0.3s ease-in-out"}})})},F=()=>{const{id:i}=A(),l=D(),[r,c]=o.useState(null),[a,b]=o.useState([]),[u,m]=o.useState([]),[j,v]=o.useState(""),[h,p]=o.useState(!0),[x,g]=o.useState(null);o.useEffect(()=>{const t=async()=>{try{const n=await y.getById(i);c(n),m(n.tasks||[])}catch{g("Failed to fetch project data")}finally{p(!1)}},d=async()=>{try{const n=await T.getAll();n&&Array.isArray(n)&&b(n)}catch(n){console.error("Failed to fetch clients",n)}};t(),d()},[i]);const s=t=>{const{name:d,value:n}=t.target;c(S=>({...S,[d]:n}))},C=async t=>{t.preventDefault(),p(!0);try{await y.update(i,{...r,tasks:u}),l("/projects")}catch{g("Failed to save project"),p(!1)}},f=async()=>{if(window.confirm("Are you sure you want to delete this project?")){p(!0);try{await y.delete(i),l("/projects")}catch{g("Failed to delete project"),p(!1)}}},w=()=>{j.trim()!==""&&(m([...u,{id:Date.now(),description:j,status:"Pending"}]),v(""))},k=t=>{m(u.filter(d=>d.id!==t))},P=(t,d)=>{m(u.map(n=>n.id===t?{...n,status:d}:n))};return h?e.jsx("div",{children:"Loading project..."}):x?e.jsxs("div",{children:["Error: ",x]}):r?e.jsxs("div",{style:{padding:"2rem",maxWidth:"800px",margin:"0 auto"},children:[e.jsxs("h1",{children:["Edit Project: ",r.name]}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{children:"Project Name"}),e.jsx("input",{type:"text",name:"name",value:r.name,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Project Code"}),e.jsx("input",{type:"text",name:"projectCode",value:r.projectCode,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Client Name"}),e.jsxs("select",{name:"clientName",value:r.clientName,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"},children:[e.jsx("option",{value:"",children:"Select a client"}),a.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Client Address"}),e.jsx("input",{type:"text",name:"clientAddress",value:r.clientAddress,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Request Date"}),e.jsx("input",{type:"date",name:"requestDate",value:r.requestDate,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Due Date"}),e.jsx("input",{type:"date",name:"dueDate",value:r.dueDate,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Priority"}),e.jsxs("select",{name:"priority",value:r.priority,onChange:s,style:{width:"100%",padding:"0.5rem"},children:[e.jsx("option",{children:"Low"}),e.jsx("option",{children:"Medium"}),e.jsx("option",{children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{name:"status",value:r.status,onChange:s,style:{width:"100%",padding:"0.5rem"},children:[e.jsx("option",{children:"Planning"}),e.jsx("option",{children:"In Progress"}),e.jsx("option",{children:"On Hold"}),e.jsx("option",{children:"Completed"}),e.jsx("option",{children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx("select",{name:"category",value:r.category,onChange:s,style:{width:"100%",padding:"0.5rem"},children:R.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),e.jsxs("div",{style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Requested By"}),e.jsx("input",{type:"text",name:"requestedBy",value:r.requestedBy,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"}})]}),e.jsxs("div",{style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{name:"description",value:r.description,onChange:s,rows:"4",style:{width:"100%",padding:"0.5rem"}})]})]}),e.jsx("h2",{style:{color:"#22314a",marginTop:"2rem",marginBottom:"1rem"},children:"Tasks"}),e.jsx(E,{tasks:u}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem"},children:[e.jsx("input",{type:"text",placeholder:"New task description",value:j,onChange:t=>v(t.target.value),style:{flex:1,padding:"0.5rem"}}),e.jsx("button",{type:"button",onClick:w,style:{background:"#5cb85c",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"4px",cursor:"pointer"},children:"Add Task"})]}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid #ddd"},children:[e.jsx("th",{style:{padding:"0.5rem",textAlign:"left"},children:"Description"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"left"},children:"Status"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"left"},children:"Actions"})]})}),e.jsx("tbody",{children:u.map(t=>e.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[e.jsx("td",{style:{padding:"0.5rem"},children:t.description}),e.jsx("td",{style:{padding:"0.5rem"},children:e.jsx(B,{status:t.status,onUpdate:d=>P(t.id,d)})}),e.jsx("td",{style:{padding:"0.5rem"},children:e.jsx("button",{type:"button",onClick:()=>k(t.id),style:{background:"#dc3545",color:"white",border:"none",padding:"0.25rem 0.5rem",borderRadius:"4px",cursor:"pointer"},children:"Remove"})})]},t.id))})]}),e.jsxs("div",{style:{marginTop:"2rem",display:"flex",justifyContent:"space-between"},children:[e.jsx("button",{type:"submit",disabled:h,style:{background:"#22314a",color:"white",padding:"0.75rem 1.5rem",border:"none",borderRadius:"4px",cursor:"pointer"},children:h?"Saving...":"Save Project"}),e.jsx("button",{type:"button",onClick:f,disabled:h,style:{background:"#dc3545",color:"white",padding:"0.75rem 1.5rem",border:"none",borderRadius:"4px",cursor:"pointer"},children:h?"Deleting...":"Delete Project"})]}),x&&e.jsx("p",{style:{color:"red",marginTop:"1rem"},children:x})]})]}):e.jsx("div",{children:"Project not found."})};export{F as default};
