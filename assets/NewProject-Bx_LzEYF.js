import{j as e,e as S,p as A}from"./index-Bl6mqZnr.js";import{u as P,b as d}from"./vendor-Dd4J3GVN.js";const x=["Pending","In Progress","Completed"],T=[{id:"security",name:"Security"},{id:"access-control",name:"Access Control"},{id:"it",name:"Information Technology"},{id:"cctv",name:"CCTV"},{id:"consultation",name:"Consultation"},{id:"maintenance",name:"Routine Maintenance"},{id:"av",name:"Audio Visual"},{id:"automation",name:"Automation"},{id:"network",name:"Network Programming"},{id:"electrical",name:"Electrical Works"},{id:"contractor",name:"Contractor"},{id:"garden",name:"Garden Works"},{id:"lighting",name:"Electrical & Lighting"}],q=({status:i,onUpdate:r})=>{const a=x.indexOf(i),o=()=>{const h=(a+1)%x.length;r(x[h])},l=()=>{switch(i){case"Completed":return"#198754";case"In Progress":return"#0d6efd";default:return"#6c757d"}};return e.jsx("span",{onClick:o,style:{background:l(),color:"white",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",cursor:"pointer"},children:i})},N=({tasks:i})=>{const r=i.filter(l=>l.status==="Completed").length,a=i.length,o=a>0?r/a*100:0;return e.jsx("div",{style:{width:"100%",backgroundColor:"#e9ecef",borderRadius:"4px",overflow:"hidden",marginBottom:"1rem"},children:e.jsx("div",{style:{width:`${o}%`,backgroundColor:"#198754",height:"10px",transition:"width 0.3s ease-in-out"}})})},R=()=>{const i=P(),[r,a]=d.useState({projectName:"",projectCode:"",clientName:"",clientAddress:"",requestDate:"",dueDate:"",priority:"Medium",status:"Planning",requestedBy:"",description:"",category:"security"}),[o,l]=d.useState(!1),[h,g]=d.useState(null),[c,m]=d.useState([]),[p,j]=d.useState(""),[y,C]=d.useState([]),s=t=>{const{name:n,value:u}=t.target;a(k=>({...k,[n]:u}))},v=()=>{p.trim()!==""&&(m([...c,{id:Date.now(),description:p,status:"Pending"}]),j(""))},b=t=>{m(c.filter(n=>n.id!==t))},w=(t,n)=>{m(c.map(u=>u.id===t?{...u,status:n}:u))};d.useEffect(()=>{(async()=>{try{const n=await S.getAll();n&&Array.isArray(n)&&C(n)}catch(n){console.error("Failed to fetch clients",n)}})()},[]);const f=async t=>{t.preventDefault(),l(!0),g(null);try{await A.create(r),i("/projects")}catch(n){g(n.message||"Failed to create project"),l(!1)}};return e.jsxs("div",{style:{padding:"2rem",maxWidth:"800px",margin:"0 auto"},children:[e.jsx("h1",{style:{color:"#22314a",marginBottom:"2rem"},children:"Add New Project"}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{children:"Project Name"}),e.jsx("input",{type:"text",name:"projectName",value:r.projectName,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Project Code"}),e.jsx("input",{type:"text",name:"projectCode",value:r.projectCode,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Client Name"}),e.jsxs("select",{name:"clientName",value:r.clientName,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"},children:[e.jsx("option",{value:"",children:"Select a client"}),y.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Client Address"}),e.jsx("input",{type:"text",name:"clientAddress",value:r.clientAddress,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Request Date"}),e.jsx("input",{type:"date",name:"requestDate",value:r.requestDate,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Due Date"}),e.jsx("input",{type:"date",name:"dueDate",value:r.dueDate,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Priority"}),e.jsxs("select",{name:"priority",value:r.priority,onChange:s,style:{width:"100%",padding:"0.5rem"},children:[e.jsx("option",{children:"Low"}),e.jsx("option",{children:"Medium"}),e.jsx("option",{children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{name:"status",value:r.status,onChange:s,style:{width:"100%",padding:"0.5rem"},children:[e.jsx("option",{children:"Planning"}),e.jsx("option",{children:"In Progress"}),e.jsx("option",{children:"On Hold"}),e.jsx("option",{children:"Completed"}),e.jsx("option",{children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx("select",{name:"category",value:r.category,onChange:s,style:{width:"100%",padding:"0.5rem"},children:T.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),e.jsxs("div",{style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Requested By"}),e.jsx("input",{type:"text",name:"requestedBy",value:r.requestedBy,onChange:s,required:!0,style:{width:"100%",padding:"0.5rem"}})]}),e.jsxs("div",{style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{name:"description",value:r.description,onChange:s,rows:"4",style:{width:"100%",padding:"0.5rem"}})]})]}),e.jsx("h2",{style:{color:"#22314a",marginTop:"2rem",marginBottom:"1rem"},children:"Tasks"}),e.jsx(N,{tasks:c}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem"},children:[e.jsx("input",{type:"text",placeholder:"New task description",value:p,onChange:t=>j(t.target.value),style:{flex:1,padding:"0.5rem"}}),e.jsx("button",{type:"button",onClick:v,style:{background:"#5cb85c",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"4px",cursor:"pointer"},children:"Add Task"})]}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid #ddd"},children:[e.jsx("th",{style:{padding:"0.5rem",textAlign:"left"},children:"Description"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"left"},children:"Status"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"left"},children:"Actions"})]})}),e.jsx("tbody",{children:c.map(t=>e.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[e.jsx("td",{style:{padding:"0.5rem"},children:t.description}),e.jsx("td",{style:{padding:"0.5rem"},children:e.jsx(q,{status:t.status,onUpdate:n=>w(t.id,n)})}),e.jsx("td",{style:{padding:"0.5rem"},children:e.jsx("button",{type:"button",onClick:()=>b(t.id),style:{background:"#dc3545",color:"white",border:"none",padding:"0.25rem 0.5rem",borderRadius:"4px",cursor:"pointer"},children:"Remove"})})]},t.id))})]}),e.jsx("button",{type:"submit",disabled:o,style:{background:"#22314a",color:"white",padding:"0.75rem 1.5rem",border:"none",borderRadius:"4px",cursor:"pointer"},children:o?"Creating...":"Create Project"}),h&&e.jsx("p",{style:{color:"red",marginTop:"1rem"},children:h})]})]})};export{R as default};
